# JC

## [Day 1] - [5/11]

### âœ… ä»»å‹™ç´€éŒ„
<!-- - åšäº†å“ªäº›äº‹ï¼ˆå®‰è£ã€è·‘ codeã€æ¸¬è©¦åƒæ•¸...ï¼‰ -->
- æˆåŠŸå®Œæˆ node1 çš„ setup

### ğŸ§ª è¨­å®šè³‡è¨Š
<!-- - ä½¿ç”¨äº†å“ªäº›å¥—ä»¶ / flag / ç¯€é» -->
- ä½¿ç”¨ docker image å­˜å– BMC console
- é–‹æ©Ÿæ™‚æŒ‰ F12 å°å…¥ Ubuntu å®‰è£æª”
- å…¶é¤˜éƒ¨åˆ†ç…§è‘— Week4 æŠ•å½±ç‰‡åš

### ğŸ› å•é¡Œ
<!-- - é‡åˆ°ä»€éº¼å•é¡Œï¼Ÿåˆæ­¥åˆ†æï¼Ÿ -->
- ç¡¬ç¢Ÿé¸æ“‡çš„éƒ¨åˆ†ä¸ç¢ºå®šæœ‰æ²’æœ‰é¸åˆ° SSD

### ğŸ—‚ Version
<!-- - ç‰ˆæœ¬å‘½å + ç‹€æ…‹ï¼ˆæˆåŠŸ / å¤±æ•— / å¾…é©—è­‰ï¼‰ -->

### ğŸ“ Log / Output
<!-- - æ”¾é€£çµæˆ–æ–‡å­—å€å¡Š -->

### ğŸ–¼ åœ–ç‰‡ï¼ˆå¯é¸ï¼‰
![](image/jc/node1_setup_success.png)
![](image/jc/node1_storage.png)

---

## [Day 2] - [5/12]

### âœ… ä»»å‹™ç´€éŒ„
<!-- - åšäº†å“ªäº›äº‹ï¼ˆå®‰è£ã€è·‘ codeã€æ¸¬è©¦åƒæ•¸...ï¼‰ -->
- æˆåŠŸå®Œæˆ node2 çš„ setup
- è¨­å®š InfiniBand
    - ref: [æ¯”è³½è³‡è¨Š HackMD](https://hackmd.io/@J-Hsu/H1IaiS8gee?stext=755%3A455%3A0%3A1747803279%3A9b6vk1)
- è¨­å®šå…©å°æ©Ÿå™¨ ssh äº’é€š
- è¨­å®š NFS æ›è¼‰

### ğŸ§ª è¨­å®šè³‡è¨Š
<!-- - ä½¿ç”¨äº†å“ªäº›å¥—ä»¶ / flag / ç¯€é» -->
- node2 è£æ©Ÿæµç¨‹èˆ‡ node1 ç›¸åŒ
- node1 ä»¥ apt å®‰è£ `nfs-kernel-server`
- node1 ä¿®æ”¹ `/etc/exports`
    - ref: [week4 slide p.35](https://docs.google.com/presentation/d/1J_uiu7OeLwa8M2NMKNnp1Ie8-SlwvbCAPLDGmpLASYc/edit?usp=sharing)
- node2 ä¿®æ”¹ `/etc/fstab`
- ä¿®æ”¹ `/etc/hosts` è®“ ssh æ™‚ä¸ç”¨æ‰“ IP address
- åŠ å…¥ node1 çš„ public key åˆ° node2 çš„ `~/.ssh/authorized_keys` è®“ node1 èƒ½å¤ é€£ç·šåˆ° node2
- åŠ å…¥æˆ‘çš„ public key åˆ° node1 çš„ `~/.ssh/authorized_keys` é”æˆå…å¯†ç¢¼ç™»å…¥

### ğŸ› å•é¡Œ
<!-- - é‡åˆ°ä»€éº¼å•é¡Œï¼Ÿåˆæ­¥åˆ†æï¼Ÿ -->
- å®‰è£ node2 çš„ OS æ™‚ç™¼ç¾æœ‰å·²è¢«ä½¿ç”¨çš„ç¡¬ç¢Ÿ
- node2 OS å®‰è£å®Œæˆå¾Œé‡é–‹æ©Ÿæ²’æœ‰é€²å…¥ Ubuntu
    - èª¿æ•´å•Ÿå‹•é †åº è§£æ±º

### ğŸ—‚ Version
<!-- - ç‰ˆæœ¬å‘½å + ç‹€æ…‹ï¼ˆæˆåŠŸ / å¤±æ•— / å¾…é©—è­‰ï¼‰ -->

### ğŸ“ Log / Output
<!-- - æ”¾é€£çµæˆ–æ–‡å­—å€å¡Š -->

### ğŸ–¼ åœ–ç‰‡ï¼ˆå¯é¸ï¼‰
![](image/jc/node2_storage.png)

---

## [Day 3] - [5/13]

### âœ… ä»»å‹™ç´€éŒ„
<!-- - åšäº†å“ªäº›äº‹ï¼ˆå®‰è£ã€è·‘ codeã€æ¸¬è©¦åƒæ•¸...ï¼‰ -->
- å®‰è£ Gromacs
- å˜—è©¦åŸ·è¡Œ benchMEM

### ğŸ§ª è¨­å®šè³‡è¨Š
<!-- - ä½¿ç”¨äº†å“ªäº›å¥—ä»¶ / flag / ç¯€é» -->
- Gromacs å®‰è£åƒè€ƒ week12 æŠ•å½±ç‰‡ p.14

### ğŸ› å•é¡Œ
<!-- - é‡åˆ°ä»€éº¼å•é¡Œï¼Ÿåˆæ­¥åˆ†æï¼Ÿ -->
- benchMEM ä»€éº¼åƒæ•¸éƒ½æ²’å‹•ï¼Œè·‘å‡ºçš„æ•¸æ“šèˆ‡åŠ©æ•™ baseline ç›¸å·®ç”šé  (å¥½å¾ˆå¤š)
- é›–ç„¶æœ‰åœ¨ `.bashrc` ä¸­ source Gromacs çš„è¨­å®š scriptï¼Œç”šè‡³ç›´æ¥ export `gmx_mpi` çš„ pathï¼Œä½†ç”¨åˆ° `gmx_mpi` æ™‚ï¼Œnode2 æœƒæ‰¾ä¸åˆ°é€™å€‹æŒ‡ä»¤
    - æ”¹ç”¨ `mpirun -np ... /opt/gromacs-2025.1-mpi/bin/gmx_mpi ...` ç›´æ¥æŒ‡å®šåŸ·è¡Œæª”çš„çµ•å°è·¯å¾‘æ‰èƒ½æˆåŠŸåŸ·è¡Œ

### ğŸ—‚ Version
<!-- - ç‰ˆæœ¬å‘½å + ç‹€æ…‹ï¼ˆæˆåŠŸ / å¤±æ•— / å¾…é©—è­‰ï¼‰ -->
- gromacs_benchMEM_default (stat: å¾…é©—è­‰)

### ğŸ“ Log / Output
<!-- - æ”¾é€£çµæˆ–æ–‡å­—å€å¡Š -->
![](image/jc/benchMEM_v1.png)

### ğŸ–¼ åœ–ç‰‡ï¼ˆå¯é¸ï¼‰

---

## [Day 4] - [5/19]

### âœ… ä»»å‹™ç´€éŒ„
<!-- - åšäº†å“ªäº›äº‹ï¼ˆå®‰è£ã€è·‘ codeã€æ¸¬è©¦åƒæ•¸...ï¼‰ -->
- é‡æ–°å˜—è©¦åŸ·è¡Œ benchMEMï¼Œæ•¸æ“šå’ŒåŠ©æ•™ baseline ç›¸è¿‘è¨±å¤š
- åŸ·è¡Œ benchRIBï¼Œæ•¸æ“šå’ŒåŠ©æ•™ baseline ç›¸è¿‘
- æª¢æŸ¥ hyperthreading æ˜¯å¦é–‹å•Ÿ
- åƒè€ƒç¶²è·¯è³‡æ–™å˜—è©¦å„ªåŒ– gromacs performance
- å˜—è©¦ä»¥ `gmx_mpi tune_pme` å·¥å…·æ‰¾å‡ºæœ€ä½³çš„ `-npme` åƒæ•¸

### ğŸ§ª è¨­å®šè³‡è¨Š
<!-- - ä½¿ç”¨äº†å“ªäº›å¥—ä»¶ / flag / ç¯€é» -->

### ğŸ› å•é¡Œ
<!-- - é‡åˆ°ä»€éº¼å•é¡Œï¼Ÿåˆæ­¥åˆ†æï¼Ÿ -->
- ä¸çŸ¥é“é€ æˆ performance èˆ‡ä¸Šæ¬¡åŸ·è¡Œçµæœä¸åŒçš„åŸå› 
- ç”¨ä»¥ä¸‹æŒ‡ä»¤åŸ·è¡Œ `gmx_mpi tune_pme` 
    ```bash
    mpirun -np 24 --host node1:12,node2:12 \ 
    /opt/gromacs-2025.1-mpi/bin/gmx_mpi tune_pme \ 
    -mdrun /opt/gromacs-2025.1-mpi/bin/gmx_mpigmx_mpi \ 
    -s benchMEM.tpr`
    ```
    æœƒè¼¸å‡º
    ```
    Fatal error:
    Cannot execute mdrun. Please check benchtest.log for problems!
    ```
    ä¸¦åœ¨ç”¢ç”Ÿçš„ `benchtest.log` ä¸­å¯«å…¥
    ```
    mpirun: Error: unknown option "-np"
    ```
- æ”¹ç”¨ä»¥ä¸‹æŒ‡ä»¤åŸ·è¡Œ
    ```bash
    /opt/gromacs-2025.1-mpi/bin/gmx_mpi tune_pme \
    -mdrun /opt/gromacs-2025.1-mpi/bin/gmx_mpi \
    -np 24 --host node1:12,node2:12\
    -ntmpi 24 \
    -ntomp 1 \
    -s benchMEM.tpr
    ```
    çµæœè¼¸å‡ºå¦ä¸€éŒ¯èª¤è¨Šæ¯: 
    ```
    Fatal error:
    Can't run multi-threaded MPI simulation yet!
    ```

### ğŸ—‚ Version
<!-- - ç‰ˆæœ¬å‘½å + ç‹€æ…‹ï¼ˆæˆåŠŸ / å¤±æ•— / å¾…é©—è­‰ï¼‰ -->
- gromacs_optim_v1 (stat: å¤±æ•—)

### ğŸ“ Log / Output
<!-- - æ”¾é€£çµæˆ–æ–‡å­—å€å¡Š -->
- benchMEM baseline
    ![](image/jc/benchMEM_v2.png)
- benchRIB baseline
    ![](image/jc/benchRIB_v1.png)

### ğŸ–¼ åœ–ç‰‡ï¼ˆå¯é¸ï¼‰

---

## [Day 5] - [5/20]

### âœ… ä»»å‹™ç´€éŒ„
<!-- - åšäº†å“ªäº›äº‹ï¼ˆå®‰è£ã€è·‘ codeã€æ¸¬è©¦åƒæ•¸...ï¼‰ -->
- mpi çªç„¶å› ç‚ºä¸æ˜åŸå› ç„¡æ³•æ­£å¸¸åŸ·è¡Œï¼Œå˜—è©¦ä¿®å¾©

### ğŸ§ª è¨­å®šè³‡è¨Š
<!-- - ä½¿ç”¨äº†å“ªäº›å¥—ä»¶ / flag / ç¯€é» -->
- åˆªé™¤åŸå…ˆä»¥å®‰è£æª”å®‰è£çš„ OpenMPI (`/opt/openmpi...`)
- é‡æ–°å˜—è©¦ä»¥å®‰è£æª”æ‰‹å‹•å®‰è£ OpenMPIï¼ŒåŒæ¨£éŒ¯èª¤ä»ç„¶æœƒå‡ºç¾

### ğŸ› å•é¡Œ
<!-- - é‡åˆ°ä»€éº¼å•é¡Œï¼Ÿåˆæ­¥åˆ†æï¼Ÿ -->
- é€éæ‰‹å‹•å®‰è£çš„ OpenMPI ä»æœƒå‡ºç¾éŒ¯èª¤
- å…¶ä»–çµ„å“¡å˜—è©¦ä»¥ spack å®‰è£ OpenMPIï¼Œé›–ç„¶å¯åœ¨å–®ä¸€ node åŸ·è¡Œï¼Œä½†å› ç‚ºä»¥ `mpirun` ä½¿ç”¨å…¶ä»– node æ™‚ä¸æœƒè‡ªå‹• load openmpi ï¼Œå°è‡´å¦ä¸€ node ç„¡æ³•åŸ·è¡Œ

### ğŸ—‚ Version
<!-- - ç‰ˆæœ¬å‘½å + ç‹€æ…‹ï¼ˆæˆåŠŸ / å¤±æ•— / å¾…é©—è­‰ï¼‰ -->

### ğŸ“ Log / Output
<!-- - æ”¾é€£çµæˆ–æ–‡å­—å€å¡Š -->
![](image/jc/mpi_error.png)

### ğŸ–¼ åœ–ç‰‡ï¼ˆå¯é¸ï¼‰